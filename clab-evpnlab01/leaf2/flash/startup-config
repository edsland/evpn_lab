! Startup-config last modified at Sun Oct 29 13:37:06 2023 by root
! device: leaf2 (cEOSLab, EOS-4.30.3M-33434057.4303M (engineering build))
!
no aaa root
!
username admin privilege 15 role network-admin secret sha512 $6$oh9.tF.hCi5UThDa$PYcmGcQpOtQ2RLz292Yc7V3wabN03.2UKo7ovnIFOlmZLOAfUNwTBaYDKD24aOcVYprf.K7f.5NaRtMtwT/ul.
!
transceiver qsfp default-mode 4x10G
!
service routing protocols model multi-agent
!
hostname leaf2
!
spanning-tree mode mstp
!
system l1
   unsupported speed action error
   unsupported error-correction action error
!
vlan 100
   name CORP_NET
!
vlan 200
   name GUEST_NET
!
vlan 300
   name SHARED-SERVICES
!
vrf instance COKE
!
management api http-commands
   no shutdown
!
management api gnmi
   transport grpc default
!
management api netconf
   transport ssh default
!
interface Ethernet1
   mtu 9214
   no switchport
   ipv6 enable
   isis enable UNDERLAY
   isis network point-to-point
!
interface Ethernet2
   mtu 9214
   no switchport
   ipv6 enable
   isis enable UNDERLAY
   isis network point-to-point
!
interface Ethernet10
   switchport trunk allowed vlan 100,200,300
   switchport mode trunk
   spanning-tree portfast
   spanning-tree bpdufilter enable
!
interface Loopback0
   description BGP_Source
   ipv6 enable
   ipv6 address 2001:dbb::102/128
   isis enable UNDERLAY
   isis passive
!
interface Loopback1
   description VTEP_Source
   ipv6 enable
   ipv6 address 2001:dcc::102/128
   isis enable UNDERLAY
   isis passive
!
interface Management0
   ip address 172.20.20.6/24
   ipv6 address 2001:172:20:20::6/64
!
interface Vlan200
   vrf COKE
   ip address 192.168.20.3/24
   ipv6 enable
   ipv6 address 2001:beef:200::3/64
   ip virtual-router address 192.168.20.1
   ip virtual-router address 192.168.200.1
   ipv6 virtual-router address 2001:beef:200::1
!
interface Vlan300
   vrf COKE
   ip address 192.168.30.3/24
   ipv6 enable
   ipv6 address 2001:beef:300::3/64
   ip virtual-router address 192.168.30.1
   ipv6 virtual-router address 2001:beef:300::1
!
interface Vxlan1
   vxlan source-interface Loopback1
   vxlan udp-port 4789
   vxlan encapsulation ipv6
   vxlan vlan 100 vni 100
   vxlan vlan 200 vni 200
   vxlan vlan 300 vni 300
   vxlan vrf COKE vni 1000
   vxlan flood vtep 2001:dbb::101
   vxlan learn-restrict any
!
ip virtual-router mac-address 00:02:de:ad:be:ef
!
ip routing ipv6 interfaces 
ip routing vrf COKE
!
ipv6 unicast-routing
ipv6 unicast-routing vrf COKE
!
ip route 0.0.0.0/0 172.20.20.1
!
ipv6 route ::/0 2001:172:20:20::1
!
router bgp 65000
   router-id 1.1.1.102
   no bgp default ipv4-unicast
   distance bgp 20 200 200
   neighbor evpn peer group
   neighbor evpn remote-as 65000
   neighbor evpn update-source Loopback0
   neighbor evpn ebgp-multihop 3
   neighbor evpn send-community extended
   neighbor evpn maximum-routes 12000 warning-only
   neighbor 2001:dbb::1 peer group evpn
   neighbor 2001:dbb::2 peer group evpn
   !
   vlan 100
      rd 1.1.1.102:100
      route-target both 100:100
   !
   vlan 200
      rd 1.1.1.102:200
      route-target both 200:200
   !
   vlan 300
      rd 1.1.1.102:300
      route-target both 300:300
   !
   address-family evpn
      neighbor evpn activate
   !
   vrf COKE
      rd 1.1.1.102:1000
      route-target import evpn 1000:1000
      route-target export evpn 1000:1000
      redistribute connected
!
router isis UNDERLAY
   net 49.0000.0000.0000.0102.00
   is-type level-2
   log-adjacency-changes
   advertise passive-only
   !
   address-family ipv6 unicast
!
end
